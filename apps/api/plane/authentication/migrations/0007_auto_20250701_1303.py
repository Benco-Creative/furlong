# Generated by Django 4.2.22 on 2025-07-01 13:03

from django.db import migrations

from plane.authentication.utils.oauth_utils import add_app_bots_to_existing_projects


def add_app_bots_to_existing_projects_migration(apps, schema_editor):
    app_installation_model = apps.get_model("authentication", "WorkspaceAppInstallation")
    project_model = apps.get_model("db", "Project")
    project_member_model = apps.get_model("db", "ProjectMember")
    add_app_bots_to_existing_projects(
        workspace_app_installation_model=app_installation_model,
        project_model=project_model,
        project_member_model=project_member_model,
    )

class Migration(migrations.Migration):

    dependencies = [
        ('authentication', '0006_auto_20250625_1426'),
        ("db", "__first__"),
    ]

    operations = [
        # rollback is not needed as we are running this in atomic transaction
        migrations.RunPython(add_app_bots_to_existing_projects_migration, reverse_code=migrations.RunPython.noop),
    ]
